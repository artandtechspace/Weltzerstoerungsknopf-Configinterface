import{R as e,l as T,D as y}from"./Dialog.9b9f99a2.js";import{E as f,o as _,a as m,S as v}from"./FeedbackUtil.61c64b8e.js";import{_ as R,J as S,K as a,L as r,q as o,V as x,M as l,N as b,O as u,P as h,F as g,aq as D,ao as E,Q as O}from"./index.9eabea1d.js";const N={type:"object",patternProperties:{".*":{type:"object",required:["icon","subtext"],properties:{icon:{type:"string"},subtext:{type:["string","null"]}}}}},w={data:()=>({availableTests:void 0,status:e.LOADING,errorMessage:void 0}),methods:{async loadData(){this.status=e.LOADING;try{var t=await T(f.tests.get,N);this.availableTests=t,this.status=e.SUCCESS}catch(s){this.errorMessage=s,this.status=e.ERROR}},async sendTestStart(t){this.status=e.LOADING;try{var s=await fetch(f.tests.start,{method:"POST",mode:"cors",body:t});if(s.ok){var i=this.availableTests[t];i.subtext===void 0||i.subtext===null?_(this,"Test is starting...","success","mdi-bell-outline",1200):m(this,i.subtext,"Test is starting","primary",[{text:"close"}]),this.status=e.SUCCESS;return}switch(s.status){case 412:throw"Tests can only be run in idle state";case 405:throw setTimeout(this.loadData.bind(this),1e3),"Test couldn't be found? Refreshing tests...";default:throw s.statusText}}catch(p){var n=()=>this.sendTestStart(t);m(this,p.toString(),"Error","error",[{text:"Retry",action:n},{text:"Close"}])}this.status=e.SUCCESS},onRefreshClicked(){this.loadData()},onTestClicked(t){this.sendTestStart(t)}},mounted(){this.loadData()},setup(){return{RequestStatus:e}},components:{Dialog:y,Snackbar:v}},q={key:0,class:"d-flex justify-center align-center h-100"},L={key:1,class:"d-flex justify-center flex-column align-center h-100"},V=O("div",{class:"text-h4 pa-2"},"Error retreiving data",-1),j={key:2,class:"d-flex align-center flex-column"};function A(t,s,i,n,p,c){const k=S("Dialog"),C=S("Snackbar");return a(),r(g,null,[o(k,{ref:"dialog"},null,512),o(C,{ref:"snackbar"},null,512),t.status===n.RequestStatus.LOADING?(a(),r("div",q,[o(x,{color:"primary",indeterminate:""})])):t.status===n.RequestStatus.ERROR?(a(),r("div",L,[V,l(" "+b(t.errorMessage)+" ",1),o(h,{"prepend-icon":"mdi-refresh",class:"mt-12",onClick:c.loadData},{default:u(()=>[l(" Refresh ")]),_:1},8,["onClick"])])):(a(),r("div",j,[(a(!0),r(g,null,D(Object.keys(t.availableTests),d=>(a(),E(h,{class:"mt-4","prepend-icon":t.availableTests[d].icon,onClick:()=>c.onTestClicked(d),color:"primary"},{default:u(()=>[l(" Test "+b(d),1)]),_:2},1032,["prepend-icon","onClick"]))),256)),o(h,{"prepend-icon":"mdi-refresh",onClick:c.onRefreshClicked,class:"mt-10"},{default:u(()=>[l(" Refresh ")]),_:1},8,["onClick"])]))],64)}const G=R(w,[["render",A]]);export{G as default};
